<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èªéŸ³è½‰æ–‡å­—å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 100%;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: #555;
            font-weight: bold;
            font-size: 1.1em;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .controls-row {
            display: flex;
            gap: 15px;
            width: 100%;
            flex-wrap: wrap;
        }

        button {
            flex: 1;
            padding: 10px 15px;
            font-size: 14px;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif;
            min-width: 0;
        }

        .start-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .start-btn:active {
            transform: translateY(0);
        }

        .start-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .stop-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .stop-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }

        .stop-btn:active {
            transform: translateY(0);
        }

        .stop-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .clear-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .clear-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .edit-btn {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }

        .edit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(250, 112, 154, 0.4);
        }

        .play-btn {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
            color: white;
        }

        .play-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(48, 207, 208, 0.4);
        }

        .translate-btn {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
        }

        .translate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(168, 237, 234, 0.4);
        }

        .translate-area {
            margin-top: 20px;
        }

        .chat-btn {
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            color: white;
        }

        .chat-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(246, 211, 101, 0.4);
        }

        .command-area {
            margin-top: 20px;
            display: none;
        }

        .command-area.active {
            display: block;
        }

        .copy-btn {
            margin-top: 10px;
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif;
        }

        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .copy-btn.copied {
            background: linear-gradient(135deg, #6BCF7F 0%, #4D96FF 100%);
        }

        .gorilla-btn {
            background: linear-gradient(135deg, #8B4513 0%, #654321 100%);
            color: white;
        }

        .gorilla-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 69, 19, 0.4);
        }

        .gorilla-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }

        .gorilla-modal.active {
            display: flex;
        }

        .gorilla-container {
            text-align: center;
            color: white;
        }

        .gorilla-animation {
            font-size: 200px;
            animation: gorillaFlip 0.5s infinite;
            cursor: pointer;
            user-select: none;
        }

        @keyframes gorillaFlip {
            0%, 100% {
                transform: rotateY(0deg) scale(1);
            }
            50% {
                transform: rotateY(180deg) scale(1.1);
            }
        }

        .gorilla-close {
            margin-top: 30px;
            padding: 15px 40px;
            background: linear-gradient(135deg, #f5576c 0%, #e0455a 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif;
            transition: all 0.3s;
        }

        .gorilla-close:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }

        .laugh-btn {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: white;
        }

        .laugh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }

        .laugh-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #FF6347 100%);
            justify-content: center;
            align-items: center;
        }

        .laugh-modal.active {
            display: flex;
        }

        .laugh-container {
            text-align: center;
            color: white;
        }

        .laugh-animation {
            font-size: 150px;
            animation: laughBounce 0.3s infinite;
            cursor: pointer;
            user-select: none;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        @keyframes laughBounce {
            0%, 100% {
                transform: translateY(0) scale(1) rotate(0deg);
            }
            25% {
                transform: translateY(-30px) scale(1.2) rotate(-5deg);
            }
            50% {
                transform: translateY(0) scale(1.1) rotate(5deg);
            }
            75% {
                transform: translateY(-20px) scale(1.15) rotate(-3deg);
            }
        }

        .laugh-text {
            font-size: 40px;
            margin-top: 30px;
            font-weight: bold;
            animation: laughText 0.5s infinite;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        @keyframes laughText {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.1);
            }
        }

        .laugh-close {
            margin-top: 40px;
            padding: 15px 40px;
            background: linear-gradient(135deg, #f5576c 0%, #e0455a 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif;
            transition: all 0.3s;
        }

        .laugh-close:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }

        .curse-btn {
            background: linear-gradient(135deg, #8B0000 0%, #DC143C 100%);
            color: white;
        }

        .curse-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 0, 0, 0.4);
        }

        .curse-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2C1810 0%, #8B0000 50%, #1a1a1a 100%);
            justify-content: center;
            align-items: center;
        }

        .curse-modal.active {
            display: flex;
        }

        .curse-container {
            text-align: center;
            color: white;
            max-width: 800px;
            padding: 40px;
        }

        .curse-display {
            font-size: 80px;
            font-weight: bold;
            margin-bottom: 30px;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 0 0 30px rgba(255, 0, 0, 0.8), 0 0 60px rgba(255, 0, 0, 0.5);
            animation: cursePulse 2s infinite;
        }

        @keyframes cursePulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.9;
            }
        }

        .curse-countdown {
            font-size: 30px;
            margin-bottom: 20px;
            color: #FFD700;
            font-weight: bold;
        }

        .curse-progress {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .curse-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #FF0000 0%, #FFD700 100%);
            width: 0%;
            transition: width 0.1s linear;
        }

        .curse-stats {
            font-size: 18px;
            margin-bottom: 30px;
            color: #ccc;
        }

        .curse-close {
            padding: 15px 40px;
            background: linear-gradient(135deg, #f5576c 0%, #e0455a 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif;
            transition: all 0.3s;
        }

        .curse-close:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }

        .status {
            margin-top: 20px;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 10px;
            text-align: center;
            color: #666;
            font-size: 14px;
        }

        .status.listening {
            background: #d4edda;
            color: #155724;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
        }

        .info {
            margin-top: 20px;
            padding: 15px;
            background: #e7f3ff;
            border-radius: 10px;
            color: #004085;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .info-icon {
            display: inline-block;
            margin-right: 5px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 25px;
            }

            h1 {
                font-size: 1.5em;
            }

            .controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤ èªéŸ³è½‰æ–‡å­—å·¥å…·</h1>

        <div class="input-group">
            <label for="textOutput">è½‰æ›çµæœï¼š</label>
            <textarea id="textOutput" placeholder="é»æ“Šã€Œé–‹å§‹éŒ„éŸ³ã€æŒ‰éˆ•ï¼Œç„¶å¾Œé–‹å§‹èªªè©±..."></textarea>
        </div>

        <div class="controls">
            <div class="controls-row">
                <button class="start-btn" id="startBtn">ğŸ¤ é–‹å§‹éŒ„éŸ³</button>
                <button class="stop-btn" id="stopBtn" disabled>â¹ åœæ­¢éŒ„éŸ³</button>
                <button class="clear-btn" id="clearBtn">ğŸ—‘ æ¸…é™¤æ–‡å­—</button>
                <button class="edit-btn" id="editBtn">âœï¸ AI é †ç¨¿</button>
                <button class="play-btn" id="playBtn">ğŸ”Š èªéŸ³æ’­æ”¾</button>
                <button class="translate-btn" id="translateBtn">ğŸŒ ç¿»è­¯æˆè‹±èª</button>
                <button class="chat-btn" id="chatBtn">ğŸ¤– AI æŒ‡ä»¤</button>
                <button class="gorilla-btn" id="gorillaBtn">ğŸ¦ å¤§çŒ©çŒ©</button>
                <button class="laugh-btn" id="laughBtn">ğŸ˜‚ ä¸€ç›´ç¬‘</button>
                <button class="curse-btn" id="curseBtn">ğŸ˜¤ ç½µé«’è©±</button>
            </div>
        </div>

        <!-- AI æŒ‡ä»¤çµæœå€åŸŸ -->
        <div class="input-group command-area" id="commandArea">
            <label for="commandText">AI æŒ‡ä»¤ï¼ˆå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼‰ï¼š</label>
            <textarea id="commandText" placeholder="æ ¼å¼åŒ–å¾Œçš„æŒ‡ä»¤å°‡é¡¯ç¤ºåœ¨é€™è£¡..." readonly></textarea>
            <button class="copy-btn" id="copyCommandBtn">ğŸ“‹ å†æ¬¡è¤‡è£½</button>
        </div>

        <!-- å¤§çŒ©çŒ©å‹•ç•« -->
        <div class="gorilla-modal" id="gorillaModal">
            <div class="gorilla-container">
                <div class="gorilla-animation" id="gorillaAnimation">ğŸ¦</div>
                <button class="gorilla-close" id="gorillaClose">é—œé–‰</button>
            </div>
        </div>

        <!-- ä¸€ç›´ç¬‘å‹•ç•« -->
        <div class="laugh-modal" id="laughModal">
            <div class="laugh-container">
                <div class="laugh-animation" id="laughAnimation">ğŸ˜‚</div>
                <div class="laugh-text" id="laughText">å“ˆå“ˆå“ˆ ğŸ˜‚ å“ˆå“ˆå“ˆ ğŸ˜‚ å“ˆå“ˆå“ˆ ğŸ˜‚</div>
                <button class="laugh-close" id="laughClose">é—œé–‰</button>
            </div>
        </div>

        <!-- ç½µé«’è©±åŠŸèƒ½ -->
        <div class="curse-modal" id="curseModal">
            <div class="curse-container">
                <div class="curse-display" id="curseDisplay">æº–å‚™é–‹å§‹...</div>
                <div class="curse-countdown" id="curseCountdown">10</div>
                <div class="curse-progress">
                    <div class="curse-progress-bar" id="curseProgressBar"></div>
                </div>
                <div class="curse-stats" id="curseStats">å·²é¡¯ç¤ºï¼š0 / 0</div>
                <button class="curse-close" id="curseClose">é—œé–‰</button>
            </div>
        </div>

        <div class="input-group translate-area" id="translateArea" style="display: none;">
            <label for="translatedText">è‹±èªç¿»è­¯ï¼š</label>
            <textarea id="translatedText" placeholder="ç¿»è­¯çµæœå°‡é¡¯ç¤ºåœ¨é€™è£¡..."></textarea>
        </div>

        <div class="status" id="status">å°±ç·’</div>

        <div class="info">
            <span class="info-icon">â„¹ï¸</span>
            <strong>ä½¿ç”¨èªªæ˜ï¼š</strong><br>
            1. é»æ“Šã€Œé–‹å§‹éŒ„éŸ³ã€æŒ‰éˆ•é–‹å§‹èªéŸ³è­˜åˆ¥<br>
            2. é–‹å§‹èªªè©±ï¼Œæ‚¨çš„èªéŸ³æœƒè‡ªå‹•è½‰æ›ç‚ºæ–‡å­—<br>
            3. é»æ“Šã€Œåœæ­¢éŒ„éŸ³ã€åœæ­¢è­˜åˆ¥<br>
            4. é»æ“Šã€Œæ¸…é™¤æ–‡å­—ã€æ¸…ç©ºæ‰€æœ‰å…§å®¹<br>
            <br>
            <strong>æ³¨æ„ï¼š</strong>æ­¤åŠŸèƒ½éœ€è¦ç€è¦½å™¨æ”¯æ´èªéŸ³è­˜åˆ¥ APIï¼Œä¸”éœ€è¦éº¥å…‹é¢¨æ¬Šé™ã€‚<br>
            <br>
            <strong>æ–°å¢åŠŸèƒ½ï¼š</strong><br>
            â€¢ <strong>AI é †ç¨¿ï¼š</strong>è‡ªå‹•æ”¹å–„æ–‡å­—æ ¼å¼å’Œæ¨™é»ç¬¦è™Ÿ<br>
            â€¢ <strong>èªéŸ³æ’­æ”¾ï¼š</strong>å°‡æ–‡å­—è½‰æ›ç‚ºèªéŸ³æ’­æ”¾<br>
            â€¢ <strong>ç¿»è­¯æˆè‹±èªï¼š</strong>ä½¿ç”¨ç·šä¸Šç¿»è­¯æœå‹™å°‡æ–‡å­—ç¿»è­¯æˆè‹±èª<br>
            â€¢ <strong>AI æŒ‡ä»¤ï¼š</strong>å°‡æ–‡å­—æ ¼å¼åŒ–ç‚º claude -p "æ–‡å­—" æ ¼å¼ä¸¦è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼Œå¯ç›´æ¥è²¼åˆ° Cursor ä½¿ç”¨
        </div>
    </div>

    <script>
        const textOutput = document.getElementById('textOutput');
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const clearBtn = document.getElementById('clearBtn');
        const editBtn = document.getElementById('editBtn');
        const playBtn = document.getElementById('playBtn');
        const translateBtn = document.getElementById('translateBtn');
        const chatBtn = document.getElementById('chatBtn');
        const gorillaBtn = document.getElementById('gorillaBtn');
        const gorillaModal = document.getElementById('gorillaModal');
        const gorillaAnimation = document.getElementById('gorillaAnimation');
        const gorillaClose = document.getElementById('gorillaClose');
        const laughBtn = document.getElementById('laughBtn');
        const laughModal = document.getElementById('laughModal');
        const laughAnimation = document.getElementById('laughAnimation');
        const laughText = document.getElementById('laughText');
        const laughClose = document.getElementById('laughClose');
        const curseBtn = document.getElementById('curseBtn');
        const curseModal = document.getElementById('curseModal');
        const curseDisplay = document.getElementById('curseDisplay');
        const curseCountdown = document.getElementById('curseCountdown');
        const curseProgressBar = document.getElementById('curseProgressBar');
        const curseStats = document.getElementById('curseStats');
        const curseClose = document.getElementById('curseClose');
        const commandArea = document.getElementById('commandArea');
        const commandText = document.getElementById('commandText');
        const copyCommandBtn = document.getElementById('copyCommandBtn');
        const translatedText = document.getElementById('translatedText');
        const translateArea = document.getElementById('translateArea');
        const status = document.getElementById('status');

        let recognition = null;
        let isListening = false;
        let synth = window.speechSynthesis;
        let currentUtterance = null;

        // æª¢æŸ¥ç€è¦½å™¨æ˜¯å¦æ”¯æ´èªéŸ³è­˜åˆ¥
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();

            // è¨­å®šèªéŸ³è­˜åˆ¥åƒæ•¸
            recognition.continuous = true;  // æŒçºŒè­˜åˆ¥
            recognition.interimResults = true;  // é¡¯ç¤ºä¸­é–“çµæœ
            recognition.lang = 'zh-TW';  // ç¹é«”ä¸­æ–‡

            // é–‹å§‹è­˜åˆ¥
            recognition.onstart = () => {
                isListening = true;
                status.textContent = 'æ­£åœ¨è†è½...';
                status.className = 'status listening';
                startBtn.disabled = true;
                stopBtn.disabled = false;
            };

            // è­˜åˆ¥çµæœ
            recognition.onresult = (event) => {
                let interimTranscript = '';
                let finalTranscript = '';

                // è™•ç†æ‰€æœ‰è­˜åˆ¥çµæœ
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    if (event.results[i].isFinal) {
                        finalTranscript += transcript + ' ';
                    } else {
                        interimTranscript += transcript;
                    }
                }

                // æ›´æ–°æ–‡å­—å€åŸŸ
                const currentText = textOutput.value;
                const newText = currentText + finalTranscript;
                textOutput.value = newText;
                
                // å¦‚æœé‚„æœ‰ä¸­é–“çµæœï¼Œé¡¯ç¤ºåœ¨ç‹€æ…‹ä¸­
                if (interimTranscript) {
                    status.textContent = `æ­£åœ¨è­˜åˆ¥ï¼š${interimTranscript}`;
                }
            };

            // è­˜åˆ¥éŒ¯èª¤
            recognition.onerror = (event) => {
                console.error('èªéŸ³è­˜åˆ¥éŒ¯èª¤:', event.error);
                let errorMessage = 'ç™¼ç”ŸéŒ¯èª¤';
                
                switch(event.error) {
                    case 'no-speech':
                        errorMessage = 'æ²’æœ‰åµæ¸¬åˆ°èªéŸ³ï¼Œè«‹å†è©¦ä¸€æ¬¡';
                        break;
                    case 'audio-capture':
                        errorMessage = 'ç„¡æ³•å­˜å–éº¥å…‹é¢¨ï¼Œè«‹æª¢æŸ¥æ¬Šé™è¨­å®š';
                        break;
                    case 'not-allowed':
                        errorMessage = 'éº¥å…‹é¢¨æ¬Šé™è¢«æ‹’çµ•ï¼Œè«‹å…è¨±ä½¿ç”¨éº¥å…‹é¢¨';
                        break;
                    case 'network':
                        errorMessage = 'ç¶²è·¯éŒ¯èª¤ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·š';
                        break;
                    default:
                        errorMessage = `éŒ¯èª¤ï¼š${event.error}`;
                }
                
                status.textContent = errorMessage;
                status.className = 'status error';
                isListening = false;
                startBtn.disabled = false;
                stopBtn.disabled = true;
            };

            // è­˜åˆ¥çµæŸ
            recognition.onend = () => {
                isListening = false;
                if (status.textContent !== 'éº¥å…‹é¢¨æ¬Šé™è¢«æ‹’çµ•ï¼Œè«‹å…è¨±ä½¿ç”¨éº¥å…‹é¢¨') {
                    status.textContent = 'éŒ„éŸ³å·²åœæ­¢';
                }
                status.className = 'status';
                startBtn.disabled = false;
                stopBtn.disabled = true;
            };

            // é–‹å§‹æŒ‰éˆ•
            startBtn.addEventListener('click', () => {
                try {
                    recognition.start();
                } catch (error) {
                    status.textContent = 'ç„¡æ³•é–‹å§‹éŒ„éŸ³ï¼Œè«‹é‡è©¦';
                    status.className = 'status error';
                }
            });

            // åœæ­¢æŒ‰éˆ•
            stopBtn.addEventListener('click', () => {
                if (recognition && isListening) {
                    recognition.stop();
                }
            });

        } else {
            // ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³è­˜åˆ¥
            status.textContent = 'æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³è­˜åˆ¥åŠŸèƒ½';
            status.className = 'status error';
            startBtn.disabled = true;
            stopBtn.disabled = true;
        }

        // æ¸…é™¤æŒ‰éˆ•
        clearBtn.addEventListener('click', () => {
            textOutput.value = '';
            translatedText.value = '';
            translateArea.style.display = 'none';
            status.textContent = 'æ–‡å­—å·²æ¸…é™¤';
            status.className = 'status';
        });

        // AI é †ç¨¿åŠŸèƒ½
        editBtn.addEventListener('click', async () => {
            const text = textOutput.value.trim();
            if (!text) {
                status.textContent = 'è«‹å…ˆè¼¸å…¥æ–‡å­—';
                status.className = 'status error';
                return;
            }

            editBtn.disabled = true;
            status.textContent = 'AI æ­£åœ¨é †ç¨¿ä¸­...';
            status.className = 'status';

            try {
                // ç°¡å–®çš„é †ç¨¿é‚è¼¯ï¼ˆæ”¹å–„æ¨™é»ç¬¦è™Ÿã€å»é™¤é‡è¤‡ç©ºæ ¼ç­‰ï¼‰
                let editedText = text
                    // ç§»é™¤å¤šé¤˜çš„ç©ºæ ¼
                    .replace(/\s+/g, ' ')
                    // æ”¹å–„æ¨™é»ç¬¦è™Ÿå‰çš„ç©ºæ ¼
                    .replace(/\s+([ï¼Œã€‚ï¼ï¼Ÿã€ï¼›ï¼š])/g, '$1')
                    // ç¢ºä¿æ¨™é»ç¬¦è™Ÿå¾Œæœ‰ç©ºæ ¼ï¼ˆå¦‚æœæ˜¯ä¸­æ–‡å­—ï¼‰
                    .replace(/([ï¼Œã€‚ï¼ï¼Ÿã€ï¼›ï¼š])([^\sï¼Œã€‚ï¼ï¼Ÿã€ï¼›ï¼š])/g, '$1 $2')
                    // ç§»é™¤å¤šé¤˜çš„æ›è¡Œ
                    .replace(/\n{3,}/g, '\n\n')
                    // å»é™¤é¦–å°¾ç©ºæ ¼
                    .trim();

                // å¦‚æœæ–‡å­—æœ‰æ˜é¡¯æ”¹å–„ï¼Œå°±æ›´æ–°
                if (editedText !== text) {
                    textOutput.value = editedText;
                    status.textContent = 'é †ç¨¿å®Œæˆï¼';
                    status.className = 'status';
                } else {
                    status.textContent = 'æ–‡å­—å·²ç¶“å¾ˆé †æš¢äº†';
                    status.className = 'status';
                }
            } catch (error) {
                console.error('é †ç¨¿éŒ¯èª¤:', error);
                status.textContent = 'é †ç¨¿å¤±æ•—ï¼Œè«‹é‡è©¦';
                status.className = 'status error';
            } finally {
                editBtn.disabled = false;
            }
        });

        // èªéŸ³æ’­æ”¾åŠŸèƒ½
        playBtn.addEventListener('click', () => {
            const text = textOutput.value.trim();
            if (!text) {
                status.textContent = 'è«‹å…ˆè¼¸å…¥æ–‡å­—';
                status.className = 'status error';
                return;
            }

            // å¦‚æœæ­£åœ¨æ’­æ”¾ï¼Œå‰‡åœæ­¢
            if (synth.speaking) {
                synth.cancel();
                playBtn.textContent = 'ğŸ”Š èªéŸ³æ’­æ”¾';
                status.textContent = 'æ’­æ”¾å·²åœæ­¢';
                status.className = 'status';
                return;
            }

            // åœæ­¢ä¹‹å‰çš„æ’­æ”¾
            synth.cancel();

            // å‰µå»ºæ–°çš„èªéŸ³
            currentUtterance = new SpeechSynthesisUtterance(text);
            currentUtterance.lang = 'zh-TW';
            currentUtterance.rate = 1.0;  // èªé€Ÿ
            currentUtterance.pitch = 1.0;  // éŸ³èª¿
            currentUtterance.volume = 1.0;  // éŸ³é‡

            // æ’­æ”¾é–‹å§‹
            currentUtterance.onstart = () => {
                playBtn.textContent = 'â¸ åœæ­¢æ’­æ”¾';
                status.textContent = 'æ­£åœ¨æ’­æ”¾...';
                status.className = 'status listening';
            };

            // æ’­æ”¾çµæŸ
            currentUtterance.onend = () => {
                playBtn.textContent = 'ğŸ”Š èªéŸ³æ’­æ”¾';
                status.textContent = 'æ’­æ”¾å®Œæˆ';
                status.className = 'status';
            };

            // æ’­æ”¾éŒ¯èª¤
            currentUtterance.onerror = (event) => {
                console.error('èªéŸ³æ’­æ”¾éŒ¯èª¤:', event);
                playBtn.textContent = 'ğŸ”Š èªéŸ³æ’­æ”¾';
                status.textContent = 'æ’­æ”¾å¤±æ•—';
                status.className = 'status error';
            };

            // é–‹å§‹æ’­æ”¾
            synth.speak(currentUtterance);
        });

        // ç¿»è­¯æˆè‹±èªåŠŸèƒ½
        translateBtn.addEventListener('click', async () => {
            const text = textOutput.value.trim();
            if (!text) {
                status.textContent = 'è«‹å…ˆè¼¸å…¥æ–‡å­—';
                status.className = 'status error';
                return;
            }

            translateBtn.disabled = true;
            status.textContent = 'æ­£åœ¨ç¿»è­¯ä¸­...';
            status.className = 'status';
            translateArea.style.display = 'block';

            try {
                // ä½¿ç”¨ Google Translate APIï¼ˆå…è²»ç‰ˆæœ¬ï¼‰
                // æ³¨æ„ï¼šé€™éœ€è¦ API keyï¼Œé€™è£¡ä½¿ç”¨ç°¡å–®çš„å¯¦ç¾
                // å¯¦éš›ä½¿ç”¨æ™‚å¯ä»¥æ›¿æ›ç‚ºå…¶ä»–ç¿»è­¯æœå‹™
                
                // ä½¿ç”¨ MyMemory Translation APIï¼ˆå…è²»ï¼Œç„¡éœ€ API keyï¼‰
                const response = await fetch(
                    `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=zh-TW|en`
                );
                
                if (!response.ok) {
                    throw new Error('ç¿»è­¯æœå‹™ä¸å¯ç”¨');
                }

                const data = await response.json();
                
                if (data.responseData && data.responseData.translatedText) {
                    translatedText.value = data.responseData.translatedText;
                    status.textContent = 'ç¿»è­¯å®Œæˆï¼';
                    status.className = 'status';
                } else {
                    throw new Error('ç¿»è­¯å¤±æ•—');
                }
            } catch (error) {
                console.error('ç¿»è­¯éŒ¯èª¤:', error);
                // å¦‚æœ API å¤±æ•—ï¼Œä½¿ç”¨å‚™ç”¨æ–¹æ³•
                translatedText.value = '[ç¿»è­¯æœå‹™æš«æ™‚ç„¡æ³•ä½¿ç”¨ï¼Œè«‹ç¨å¾Œå†è©¦]';
                status.textContent = 'ç¿»è­¯æœå‹™æš«æ™‚ç„¡æ³•ä½¿ç”¨';
                status.className = 'status error';
            } finally {
                translateBtn.disabled = false;
            }
        });

        // AI æŒ‡ä»¤åŠŸèƒ½
        chatBtn.addEventListener('click', () => {
            const text = textOutput.value.trim();
            if (!text) {
                status.textContent = 'è«‹å…ˆè¼¸å…¥æ–‡å­—';
                status.className = 'status error';
                return;
            }

            // æ ¼å¼åŒ–ç‚º claude -p "æ–‡å­—" æ ¼å¼
            const formattedCommand = `claude -p "${text}"`;
            
            // é¡¯ç¤ºåœ¨æŒ‡ä»¤å€åŸŸ
            commandText.value = formattedCommand;
            commandArea.classList.add('active');
            
            // è¤‡è£½åˆ°å‰ªè²¼ç°¿
            copyToClipboard(formattedCommand);
            
            // é¡¯ç¤ºæˆåŠŸè¨Šæ¯
            status.textContent = 'æŒ‡ä»¤å·²æ ¼å¼åŒ–ä¸¦è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼';
            status.className = 'status';
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            copyCommandBtn.textContent = 'ğŸ“‹ å·²è¤‡è£½ï¼';
            copyCommandBtn.classList.add('copied');
            setTimeout(() => {
                copyCommandBtn.textContent = 'ğŸ“‹ å†æ¬¡è¤‡è£½';
                copyCommandBtn.classList.remove('copied');
            }, 2000);
        });

        // å†æ¬¡è¤‡è£½æŒ‰éˆ•
        copyCommandBtn.addEventListener('click', () => {
            const command = commandText.value;
            if (command) {
                copyToClipboard(command);
                copyCommandBtn.textContent = 'ğŸ“‹ å·²è¤‡è£½ï¼';
                copyCommandBtn.classList.add('copied');
                status.textContent = 'æŒ‡ä»¤å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼';
                status.className = 'status';
                setTimeout(() => {
                    copyCommandBtn.textContent = 'ğŸ“‹ å†æ¬¡è¤‡è£½';
                    copyCommandBtn.classList.remove('copied');
                }, 2000);
            }
        });

        // è¤‡è£½åˆ°å‰ªè²¼ç°¿çš„å‡½æ•¸
        function copyToClipboard(text) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).catch(err => {
                    console.error('è¤‡è£½å¤±æ•—:', err);
                    // å‚™ç”¨æ–¹æ³•
                    fallbackCopyToClipboard(text);
                });
            } else {
                // å‚™ç”¨æ–¹æ³•
                fallbackCopyToClipboard(text);
            }
        }

        // å‚™ç”¨è¤‡è£½æ–¹æ³•
        function fallbackCopyToClipboard(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                document.execCommand('copy');
            } catch (err) {
                console.error('å‚™ç”¨è¤‡è£½æ–¹æ³•å¤±æ•—:', err);
            }
            document.body.removeChild(textArea);
        }

        // å¤§çŒ©çŒ©åŠŸèƒ½
        gorillaBtn.addEventListener('click', () => {
            gorillaModal.classList.add('active');
            // é–‹å§‹å‹•ç•«
            startGorillaAnimation();
        });

        gorillaClose.addEventListener('click', () => {
            gorillaModal.classList.remove('active');
            stopGorillaAnimation();
        });

        // é»æ“ŠèƒŒæ™¯é—œé–‰
        gorillaModal.addEventListener('click', (e) => {
            if (e.target === gorillaModal) {
                gorillaModal.classList.remove('active');
                stopGorillaAnimation();
            }
        });

        // å¤§çŒ©çŒ©æ¯”ä¸­æŒ‡å‹•ç•«
        let gorillaInterval = null;
        let gorillaFrames = ['ğŸ¦', 'ğŸ¦ğŸ–•', 'ğŸ¦ğŸ–•', 'ğŸ¦'];
        let currentFrame = 0;

        function startGorillaAnimation() {
            if (gorillaInterval) return;
            
            gorillaInterval = setInterval(() => {
                // é¡¯ç¤ºå¤§çŒ©çŒ©æ¯”ä¸­æŒ‡
                gorillaAnimation.textContent = gorillaFrames[currentFrame];
                currentFrame = (currentFrame + 1) % gorillaFrames.length;
                
                // æ·»åŠ éš¨æ©Ÿæ—‹è½‰æ•ˆæœ
                const rotation = Math.random() * 20 - 10; // -10 åˆ° 10 åº¦
                gorillaAnimation.style.transform = `rotate(${rotation}deg) scale(1.1)`;
                
                setTimeout(() => {
                    gorillaAnimation.style.transform = 'rotate(0deg) scale(1)';
                }, 100);
            }, 300); // æ¯ 300ms æ›´æ–°ä¸€æ¬¡
        }

        function stopGorillaAnimation() {
            if (gorillaInterval) {
                clearInterval(gorillaInterval);
                gorillaInterval = null;
                gorillaAnimation.textContent = 'ğŸ¦';
                gorillaAnimation.style.transform = 'rotate(0deg) scale(1)';
                currentFrame = 0;
            }
        }

        // ä¸€ç›´ç¬‘åŠŸèƒ½
        laughBtn.addEventListener('click', () => {
            laughModal.classList.add('active');
            startLaughAnimation();
        });

        laughClose.addEventListener('click', () => {
            laughModal.classList.remove('active');
            stopLaughAnimation();
        });

        // é»æ“ŠèƒŒæ™¯é—œé–‰
        laughModal.addEventListener('click', (e) => {
            if (e.target === laughModal) {
                laughModal.classList.remove('active');
                stopLaughAnimation();
            }
        });

        // ä¸€ç›´ç¬‘å‹•ç•«
        let laughInterval = null;
        let laughEmojis = ['ğŸ˜‚', 'ğŸ¤£', 'ğŸ˜†', 'ğŸ˜„', 'ğŸ˜ƒ', 'ğŸ˜', 'ğŸ˜Š', 'ğŸ˜‹'];
        let laughWords = ['å“ˆå“ˆå“ˆ', 'å‘µå‘µå‘µ', 'å˜¿å˜¿å˜¿', 'å˜»å˜»å˜»', 'å“‡å“ˆå“ˆ', 'å™—å“ˆå“ˆ', 'å“ˆå“ˆå“ˆ', 'ğŸ˜†ğŸ˜†ğŸ˜†'];
        let currentLaughEmoji = 0;
        let currentLaughWord = 0;

        function startLaughAnimation() {
            if (laughInterval) return;
            
            laughInterval = setInterval(() => {
                // æ›´æ–°ç¬‘è‡‰è¡¨æƒ…
                laughAnimation.textContent = laughEmojis[currentLaughEmoji];
                currentLaughEmoji = (currentLaughEmoji + 1) % laughEmojis.length;
                
                // æ›´æ–°æ–‡å­—
                const word = laughWords[currentLaughWord];
                const emoji = laughEmojis[currentLaughEmoji];
                laughText.textContent = `${word} ${emoji} ${word} ${emoji} ${word} ${emoji}`;
                currentLaughWord = (currentLaughWord + 1) % laughWords.length;
                
                // æ·»åŠ éš¨æ©Ÿæ•ˆæœ
                const randomScale = 1 + Math.random() * 0.3;
                const randomRotate = (Math.random() - 0.5) * 10;
                laughAnimation.style.transform = `scale(${randomScale}) rotate(${randomRotate}deg)`;
            }, 200); // æ¯ 200ms æ›´æ–°ä¸€æ¬¡ï¼Œæ›´å¿«æ›´æç¬‘
        }

        function stopLaughAnimation() {
            if (laughInterval) {
                clearInterval(laughInterval);
                laughInterval = null;
                laughAnimation.textContent = 'ğŸ˜‚';
                laughAnimation.style.transform = 'scale(1) rotate(0deg)';
                laughText.textContent = 'å“ˆå“ˆå“ˆ ğŸ˜‚ å“ˆå“ˆå“ˆ ğŸ˜‚ å“ˆå“ˆå“ˆ ğŸ˜‚';
                currentLaughEmoji = 0;
                currentLaughWord = 0;
            }
        }

        // ç½µé«’è©±åŠŸèƒ½
        curseBtn.addEventListener('click', () => {
            curseModal.classList.add('active');
            startCurseAnimation();
        });

        curseClose.addEventListener('click', () => {
            curseModal.classList.remove('active');
            stopCurseAnimation();
        });

        // é»æ“ŠèƒŒæ™¯é—œé–‰
        curseModal.addEventListener('click', (e) => {
            if (e.target === curseModal) {
                curseModal.classList.remove('active');
                stopCurseAnimation();
            }
        });

        // é«’è©±åˆ—è¡¨ï¼ˆä¸é‡è¤‡ï¼‰
        let curseWords = [
            'å¹¹', 'æ“', 'é ', 'åª½çš„', 'ä»–åª½çš„', 'é åŒ—', 'ä¸‰å°', 'æ©Ÿæ°', 'ç™½ç™¡', 'æ™ºéšœ',
            'å¹¹ä½ å¨˜', 'æ“ä½ åª½', 'å»æ­»', 'å»¢ç‰©', 'åƒåœ¾', 'é›œç¨®', 'ç‹å…«è›‹', 'æ­»è‚¥è±¬',
            'æ­»è€é ­', 'æ­»è€å¤ªå©†', 'ç¥ç¶“ç—…', 'ç˜‹å­', 'è®Šæ…‹', 'äººæ¸£', 'æ•—é¡', 'ç•œç”Ÿ',
            'æ··å¸³', 'æ··è›‹', 'è©²æ­»', 'å»ä½ çš„', 'æ»¾', 'æ»¾è›‹', 'é–‰å˜´', 'ç…©æ­»äº†',
            'è¨å­', 'å™å¿ƒ', 'çˆ›', 'çˆ›é€äº†', 'ç³Ÿç³•', 'ç³Ÿç³•é€é ‚', 'çˆ›è²¨', 'ç ´çˆ›',
            'çˆ›äºº', 'çˆ›æ±è¥¿', 'æ­»', 'æ­»æ‰', 'æ­»é–‹', 'æ­»ä¸€é‚Š', 'æ­»é ä¸€é»',
            'æ»¾é ä¸€é»', 'èµ°é–‹', 'æ¶ˆå¤±', 'æ»¾è›‹', 'æ»¾é–‹', 'æ»¾ä¸€é‚Š', 'åˆ¥ç…©æˆ‘',
            'ç…©æ­»äº†', 'è¨å­æ­»äº†', 'å™å¿ƒæ­»äº†', 'çˆ›æ­»äº†', 'çˆ›é€äº†', 'ç³Ÿç³•æ­»äº†',
            'çˆ›è²¨', 'ç ´çˆ›è²¨', 'æ­»è‚¥è±¬', 'æ­»è€é ­', 'æ­»è€å¤ªå©†', 'ç¥ç¶“ç—…', 'ç˜‹å­',
            'è®Šæ…‹', 'äººæ¸£', 'æ•—é¡', 'ç•œç”Ÿ', 'æ··å¸³', 'æ··è›‹', 'è©²æ­»', 'å»ä½ çš„'
        ];

        let curseUsed = [];
        let curseInterval = null;
        let curseCountdownInterval = null;
        let curseProgressInterval = null;
        let currentCountdown = 10;
        let currentProgress = 0;
        let curseDisplayedCount = 0;

        function startCurseAnimation() {
            if (curseInterval) return;
            
            // é‡ç½®
            curseUsed = [];
            curseDisplayedCount = 0;
            currentCountdown = 10;
            currentProgress = 0;
            
            // é¡¯ç¤ºç¬¬ä¸€å€‹é«’è©±
            showNextCurse();
            
            // é–‹å§‹å€’æ•¸è¨ˆæ™‚
            startCurseCountdown();
        }

        function showNextCurse() {
            // å¦‚æœæ‰€æœ‰é«’è©±éƒ½ç”¨å®Œäº†ï¼Œé‡æ–°é–‹å§‹
            if (curseUsed.length >= curseWords.length) {
                curseUsed = [];
            }

            // ç²å–æœªä½¿ç”¨çš„é«’è©±
            let availableCurses = curseWords.filter(word => !curseUsed.includes(word));
            
            // å¦‚æœæ²’æœ‰å¯ç”¨é«’è©±ï¼Œé‡æ–°é–‹å§‹
            if (availableCurses.length === 0) {
                curseUsed = [];
                availableCurses = curseWords;
            }

            // éš¨æ©Ÿé¸æ“‡ä¸€å€‹
            const randomIndex = Math.floor(Math.random() * availableCurses.length);
            const selectedCurse = availableCurses[randomIndex];
            
            // æ¨™è¨˜ç‚ºå·²ä½¿ç”¨
            curseUsed.push(selectedCurse);
            
            // é¡¯ç¤º
            curseDisplay.textContent = selectedCurse;
            curseDisplayedCount++;
            curseStats.textContent = `å·²é¡¯ç¤ºï¼š${curseDisplayedCount} / ${curseWords.length}`;
        }

        function startCurseCountdown() {
            // é‡ç½®å€’æ•¸
            currentCountdown = 10;
            currentProgress = 0;
            curseCountdown.textContent = currentCountdown;
            curseProgressBar.style.width = '0%';

            // å€’æ•¸è¨ˆæ™‚
            curseCountdownInterval = setInterval(() => {
                currentCountdown--;
                curseCountdown.textContent = currentCountdown;
                
                if (currentCountdown <= 0) {
                    clearInterval(curseCountdownInterval);
                    // é¡¯ç¤ºä¸‹ä¸€å€‹é«’è©±
                    showNextCurse();
                    // é‡æ–°é–‹å§‹å€’æ•¸
                    startCurseCountdown();
                }
            }, 1000);

            // é€²åº¦æ¢å‹•ç•«
            curseProgressInterval = setInterval(() => {
                currentProgress += 1;
                curseProgressBar.style.width = currentProgress + '%';
                
                if (currentProgress >= 100) {
                    clearInterval(curseProgressInterval);
                    currentProgress = 0;
                }
            }, 100); // æ¯ 100ms æ›´æ–°ä¸€æ¬¡ï¼Œ10 ç§’ = 100 æ¬¡æ›´æ–°
        }

        function stopCurseAnimation() {
            if (curseInterval) {
                clearInterval(curseInterval);
                curseInterval = null;
            }
            if (curseCountdownInterval) {
                clearInterval(curseCountdownInterval);
                curseCountdownInterval = null;
            }
            if (curseProgressInterval) {
                clearInterval(curseProgressInterval);
                curseProgressInterval = null;
            }
            curseDisplay.textContent = 'æº–å‚™é–‹å§‹...';
            curseCountdown.textContent = '10';
            curseProgressBar.style.width = '0%';
            curseStats.textContent = 'å·²é¡¯ç¤ºï¼š0 / 0';
            curseUsed = [];
            curseDisplayedCount = 0;
            currentCountdown = 10;
            currentProgress = 0;
        }

        // ç•¶é é¢é—œé–‰æ™‚åœæ­¢è­˜åˆ¥å’Œå‹•ç•«
        window.addEventListener('beforeunload', () => {
            if (recognition && isListening) {
                recognition.stop();
            }
            stopGorillaAnimation();
            stopLaughAnimation();
            stopCurseAnimation();
        });
    </script>
</body>
</html>

